<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–í–ø—Ä–∞–≤–∞: –∑ —á–∏ —Å</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f2f6fb;
    padding: 20px;
  }
  .card {
    max-width: 650px;
    background: #fff;
    margin: auto;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,.1);
  }
  h1, h2 { text-align: center; }
  input {
    width: 100%;
    padding: 8px;
    font-size: 16px;
    margin-bottom: 15px;
  }
  .word {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
  }
  .hint-text {
    color: #f39c12;
    font-weight: bold;
  }
  select, button {
    padding: 6px 10px;
    font-size: 15px;
  }
  button {
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background: #4a90e2;
    color: #fff;
  }
  button.hint {
    background: #f39c12;
  }
  .result {
    margin-top: 15px;
    font-weight: bold;
    text-align: center;
  }
</style>
</head>

<body>

<div class="card">
  <h1>–Ü–º º—è —É—á–Ω—è</h1>
  <input id="name" placeholder="–í–≤–µ–¥–∏ —ñ–º º—è">

  <h2>–í—Å—Ç–∞–≤ –∑ –∞–±–æ —Å</h2>

  <div id="exercise"></div>

  <button onclick="check()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
  <button onclick="save()">–ó–±–µ—Ä–µ–≥—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>

  <div id="result" class="result"></div>
</div>

<script>
// üî¥ SUPABASE ‚Äî –¢–í–û–á –î–ê–ù–Ü
const client = supabase.createClient(
  "https://jwscjdbmsfzlwbrmtboz.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp3c2NqZGJtc2Z6bHdicm10Ym96Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyMzA1MDcsImV4cCI6MjA4MzgwNjUwN30.nPXq1v-G3soR4vDQt-TYy25WkVaCRYnDqEvrvegPFYw"
)

// üîπ –°–õ–û–í–ê
const words = [
  { text: "__–∞—Ñ–µ", correct: "–∑", hint: "–∫–∞—Ñ–µ" },
  { text: "__—Ç–∞—Ö", correct: "—Å", hint: "–ø—Ç–∞—Ö" },
  { text: "__–∞–¥", correct: "—Å", hint: "—Å–∞–¥" },
  { text: "__—ñ—Ä–∫–∞", correct: "–∑", hint: "–∑—ñ—Ä–∫–∞" },
  { text: "__–∏–º–∞", correct: "–∑", hint: "–∑–∏–º–∞" },
  { text: "__–æ–Ω—Ü–µ", correct: "—Å", hint: "—Å–æ–Ω—Ü–µ" },
  { text: "__—Ç—ñ–ª", correct: "—Å", hint: "—Å—Ç—ñ–ª" },
  { text: "__–≤—É–∫", correct: "–∑", hint: "–∑–≤—É–∫" },
  { text: "__–æ—à–∏—Ç", correct: "–∑", hint: "–∑–æ—à–∏—Ç" },
  { text: "__—ñ—Ä", correct: "—Å", hint: "—Å–∏—Ä" }
]

let hintPoints = 0
let usedHints = Array(words.length).fill(false)
let lastResult = null

const container = document.getElementById("exercise")

// üîπ –ì–ï–ù–ï–†–ê–¶–Ü–Ø
words.forEach((w, i) => {
  const div = document.createElement("div")
  div.className = "word"
  div.innerHTML = `
    <span id="word${i}">${i+1}. ${w.text}</span>
    <select id="a${i}">
      <option value="">?</option>
      <option value="–∑">–∑</option>
      <option value="—Å">—Å</option>
    </select>
    <button class="hint" onclick="showHint(${i})">–ü—ñ–¥–∫–∞–∑–∫–∞</button>
  `
  container.appendChild(div)
})

// üîπ –ü–Ü–î–ö–ê–ó–ö–ê –í –°–õ–û–í–Ü
function showHint(i) {
  if (!usedHints[i]) {
    usedHints[i] = true
    hintPoints += 10
    document.getElementById("word"+i).innerHTML =
      `${i+1}. ${words[i].hint} <span class="hint-text">(‚Äì10)</span>`
  }
}

// üîπ –ü–ï–†–ï–í–Ü–†–ö–ê
function check() {
  let correct = 0
  words.forEach((w, i) => {
    if (document.getElementById("a"+i).value === w.correct) {
      correct++
    }
  })

  const percent = correct * 10
  lastResult = { percent, hintPoints }

  document.getElementById("result").innerText =
    `–ó–∞ —Å–ª–æ–≤–∞: ${percent}% | –ü—ñ–¥–∫–∞–∑–∫–∏: ‚Äì${hintPoints} –±–∞–ª—ñ–≤`
}

// üîπ –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
async function save() {
  if (!lastResult) return alert("–°–ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä")

  const name = document.getElementById("name").value
  if (!name) return alert("–í–≤–µ–¥–∏ —ñ–º º—è")

  const { error } = await client.from("results").insert({
    name: name,
    words_percent: lastResult.percent,
    hint_points: lastResult.hintPoints
  })

  if (error) alert("–ü–æ–º–∏–ª–∫–∞ Supabase")
  else alert("–ó–±–µ—Ä–µ–∂–µ–Ω–æ")
}
</script>

</body>
</html>
