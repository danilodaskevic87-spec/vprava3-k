<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Вправа: з чи с (3 клас)</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f2f6fb;
    padding: 20px;
  }
  .card {
    max-width: 650px;
    margin: auto;
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,.1);
  }
  h1, h2 { text-align: center; }
  input {
    width: 100%;
    padding: 8px;
    font-size: 16px;
    margin-bottom: 15px;
  }
  .word {
    margin-bottom: 10px;
  }
  select, button {
    padding: 6px 10px;
    font-size: 15px;
  }
  button {
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background: #4a90e2;
    color: #fff;
  }
  .hint-btn {
    background: #f39c12;
    margin-bottom: 10px;
  }
  #hintText {
    color: #f39c12;
    font-weight: bold;
    margin-bottom: 10px;
    text-align: center;
  }
  #result {
    margin-top: 15px;
    font-weight: bold;
    text-align: center;
  }
</style>
</head>

<body>

<div class="card">
  <h1>Імʼя учня</h1>
  <input id="name" placeholder="Введи імʼя">

  <h2>Встав з або с</h2>

  <!-- ОДНА КНОПКА ПІДКАЗКИ -->
  <button class="hint-btn" onclick="showHint()">Підказка</button>
  <div id="hintText"></div>

  <div id="exercise"></div>

  <button onclick="check()">Перевірити</button>
  <button onclick="save()">Зберегти результат</button>

  <div id="result"></div>
</div>

<script>
/* ---------- SUPABASE ---------- */
const client = supabase.createClient(
  "https://jwscjdbmsfzlwbrmtboz.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp3c2NqZGJtc2Z6bHdicm10Ym96Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyMzA1MDcsImV4cCI6MjA4MzgwNjUwN30.nPXq1v-G3soR4vDQt-TYy25WkVaCRYnDqEvrvegPFYw"
)

/* ---------- СЛОВА (УСІ КОРЕКТНІ) ---------- */
/* У кожному слові ТІЛЬКИ ОДИН варіант правильний */
const words = [
  { text: "__афе", correct: "з" },   // кафе
  { text: "__ірка", correct: "з" },  // зірка
  { text: "__онце", correct: "с" },  // сонце
  { text: "__ад", correct: "с" },    // сад
  { text: "__вук", correct: "з" },   // звук
  { text: "__има", correct: "з" },   // зима
  { text: "__ошит", correct: "з" },  // зошит
  { text: "__тіл", correct: "с" },   // стіл
  { text: "__ир", correct: "с" },    // сир
  { text: "__ір", correct: "з" }     // зір
]

/* ---------- ЛОГІКА ---------- */
let hintUsed = false
let hintPoints = 0
let lastResult = null

const container = document.getElementById("exercise")

// генерація питань
words.forEach((w, i) => {
  container.innerHTML += `
    <div class="word">
      ${i + 1}. ${w.text}
      <select id="a${i}">
        <option value="">?</option>
        <option value="з">з</option>
        <option value="с">с</option>
      </select>
    </div>
  `
})

// одна підказка на всю сторінку
function showHint() {
  if (hintUsed) return
  hintUsed = true
  hintPoints = 10
  document.getElementById("hintText").innerText =
    "Підказка: кафе, птах (–10 балів)"
}

// перевірка
function check() {
  let correct = 0
  words.forEach((w, i) => {
    if (document.getElementById("a" + i).value === w.correct) {
      correct++
    }
  })

  const percent = correct * 10
  lastResult = { percent, hintPoints }

  document.getElementById("result").innerText =
    `За слова: ${percent}% | Підказка: –${hintPoints} балів`
}

// збереження в БД
async function save() {
  if (!lastResult) {
    alert("Спочатку перевір результат")
    return
  }

  const name = document.getElementById("name").value
  if (!name) {
    alert("Введи імʼя")
    return
  }

  const { error } = await client.from("results").insert({
    name: name,
    words_percent: lastResult.percent,
    hint_points: lastResult.hintPoints
  })

  if (error) {
    alert("Помилка збереження")
  } else {
    alert("Результат збережено")
  }
}
</script>

</body>
</html>
